<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://jeromeboyer.net/flink-studies/coding/k8s-deploy/ rel=canonical><link href=../udf_sql/ rel=prev><link href=../datastream/ rel=next><link rel=icon href=../../images/logo-blue.drawio.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>Kubernetes Deployment - Apache and Confluent Flink Studies</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#flink-kubernetes-deployment class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Apache and Confluent Flink Studies" class="md-header__button md-logo" aria-label="Apache and Confluent Flink Studies" data-md-component=logo> <img src=../../images/flink-header-logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Apache and Confluent Flink Studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Kubernetes Deployment </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/flink-studies.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../architecture/flink-sql/ class=md-tabs__link> Recipes </a> </li> <li class=md-tabs__item> <a href=../../methodology/data_as_a_product/ class=md-tabs__link> Methodology </a> </li> <li class=md-tabs__item> <a href=../../techno/ccloud-flink/ class=md-tabs__link> Related Technologies </a> </li> <li class=md-tabs__item> <a href=https://jbcodeforce.github.io/eda-studies class=md-tabs__link> EDA </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Apache and Confluent Flink Studies" class="md-nav__button md-logo" aria-label="Apache and Confluent Flink Studies" data-md-component=logo> <img src=../../images/flink-header-logo.svg alt=logo> </a> Apache and Confluent Flink Studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/flink-studies.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/ class=md-nav__link> <span class=md-ellipsis> Key Concepts </span> </a> </li> <li class=md-nav__item> <a href=../getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/ class=md-nav__link> <span class=md-ellipsis> Flink Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/fitforpurpose/ class=md-nav__link> <span class=md-ellipsis> Fit for purpose </span> </a> </li> <li class=md-nav__item> <a href=../../labs/ class=md-nav__link> <span class=md-ellipsis> Labs-Demos </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/agentic_flink/ class=md-nav__link> <span class=md-ellipsis> Agentic applications </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Recipes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Recipes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/flink-sql/ class=md-nav__link> <span class=md-ellipsis> Flink SQL concepts </span> </a> </li> <li class=md-nav__item> <a href=../flink-sql/ class=md-nav__link> <span class=md-ellipsis> Flink SQL coding </span> </a> </li> <li class=md-nav__item> <a href=../firstapp/ class=md-nav__link> <span class=md-ellipsis> First Java Apps </span> </a> </li> <li class=md-nav__item> <a href=../udf_sql/ class=md-nav__link> <span class=md-ellipsis> UDFs for SQL </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Kubernetes Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Kubernetes Deployment </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#apache-flink-kubernetes-operator-concepts class=md-nav__link> <span class=md-ellipsis> Apache Flink Kubernetes Operator Concepts </span> </a> <nav class=md-nav aria-label="Apache Flink Kubernetes Operator Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#confluent-for-kubernetes-operator-cfk class=md-nav__link> <span class=md-ellipsis> Confluent for Kubernetes Operator (CFK) </span> </a> </li> <li class=md-nav__item> <a href=#confluent-manager-for-flink-cmf class=md-nav__link> <span class=md-ellipsis> Confluent Manager for Flink (CMF) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#custom-resources class=md-nav__link> <span class=md-ellipsis> Custom Resources </span> </a> <nav class=md-nav aria-label="Custom Resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#apache-flink-specific-custom-resources class=md-nav__link> <span class=md-ellipsis> Apache Flink specific custom resources </span> </a> </li> <li class=md-nav__item> <a href=#confluent-manager-for-flink-and-fko class=md-nav__link> <span class=md-ellipsis> Confluent Manager for Flink and FKO </span> </a> </li> <li class=md-nav__item> <a href=#flink-custom-resources class=md-nav__link> <span class=md-ellipsis> Flink Custom Resources </span> </a> </li> <li class=md-nav__item> <a href=#confluent-specific-crs class=md-nav__link> <span class=md-ellipsis> Confluent Specific CRs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#external-components class=md-nav__link> <span class=md-ellipsis> External Components </span> </a> </li> <li class=md-nav__item> <a href=#cfk-installation class=md-nav__link> <span class=md-ellipsis> CFK installation </span> </a> </li> <li class=md-nav__item> <a href=#confluent-manager-for-flink-cmf_1 class=md-nav__link> <span class=md-ellipsis> Confluent Manager for Flink (CMF) </span> </a> </li> <li class=md-nav__item> <a href=#ha-configuration class=md-nav__link> <span class=md-ellipsis> HA configuration </span> </a> </li> <li class=md-nav__item> <a href=#documentations class=md-nav__link> <span class=md-ellipsis> Documentations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#apache-flink-oss class=md-nav__link> <span class=md-ellipsis> Apache Flink OSS </span> </a> <nav class=md-nav aria-label="Apache Flink OSS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deploy-apache-flink-kubernetes-operator class=md-nav__link> <span class=md-ellipsis> Deploy Apache Flink Kubernetes Operator </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#flink-config-update class=md-nav__link> <span class=md-ellipsis> Flink Config Update </span> </a> </li> <li class=md-nav__item> <a href=#flink-session-cluster class=md-nav__link> <span class=md-ellipsis> Flink Session Cluster </span> </a> <nav class=md-nav aria-label="Flink Session Cluster"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#session-deployment class=md-nav__link> <span class=md-ellipsis> Session Deployment </span> </a> </li> <li class=md-nav__item> <a href=#flink-state-snapshot class=md-nav__link> <span class=md-ellipsis> Flink State Snapshot </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#flink-application-deployment class=md-nav__link> <span class=md-ellipsis> Flink Application Deployment </span> </a> <nav class=md-nav aria-label="Flink Application Deployment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#flink-sql-processing class=md-nav__link> <span class=md-ellipsis> Flink SQL processing </span> </a> </li> <li class=md-nav__item> <a href=#flink-application class=md-nav__link> <span class=md-ellipsis> Flink Application </span> </a> </li> <li class=md-nav__item> <a href=#using-minio-for-app-deployment class=md-nav__link> <span class=md-ellipsis> Using MinIO for app deployment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#practices class=md-nav__link> <span class=md-ellipsis> Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/shift_left_utils/ class=md-nav__link> <span class=md-ellipsis> Manage CC Flink projects </span> </a> </li> <li class=md-nav__item> <a href=../datastream/ class=md-nav__link> <span class=md-ellipsis> DataStreams </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/cookbook/ class=md-nav__link> <span class=md-ellipsis> Flink Cookbook </span> </a> </li> <li class=md-nav__item> <a href=../table-api/ class=md-nav__link> <span class=md-ellipsis> Table API </span> </a> </li> <li class=md-nav__item> <a href=../stateful-func/ class=md-nav__link> <span class=md-ellipsis> Stateful function </span> </a> </li> <li class=md-nav__item> <a href=../cep/ class=md-nav__link> <span class=md-ellipsis> Complex Event Processing </span> </a> </li> <li class=md-nav__item> <a href=../terraform/ class=md-nav__link> <span class=md-ellipsis> IaC wt Terraform </span> </a> </li> <li class=md-nav__item> <a href=../../techno/fk-k8s-monitor/ class=md-nav__link> <span class=md-ellipsis> Flink on k8s Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../labs/ class=md-nav__link> <span class=md-ellipsis> Labs-Demos </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../methodology/data_as_a_product/ class=md-nav__link> <span class=md-ellipsis> Data as a product </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies/methodology/event-storming/ class=md-nav__link> <span class=md-ellipsis> Event Storming </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/shift_left_utils/ class=md-nav__link> <span class=md-ellipsis> Migrate to real-time processing tools </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/flink_project_demos/c360/spark_project/ class=md-nav__link> <span class=md-ellipsis> A C360 data product demo </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Related Technologies </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Related Technologies </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/ccloud-flink/ class=md-nav__link> <span class=md-ellipsis> Confluent Cloud Flink </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp-flink/ class=md-nav__link> <span class=md-ellipsis> Confluent Platform for Flink </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/kafka/ class=md-nav__link> <span class=md-ellipsis> Kafka Integration </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cc-tableflow/ class=md-nav__link> <span class=md-ellipsis> Confluent TableFlow </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/techno/data/#data-related-technologies class=md-nav__link> <span class=md-ellipsis> Apache Iceberg </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/kafka-studies class=md-nav__link> <span class=md-ellipsis> Kafka-studies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies class=md-nav__link> <span class=md-ellipsis> EDA </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#apache-flink-kubernetes-operator-concepts class=md-nav__link> <span class=md-ellipsis> Apache Flink Kubernetes Operator Concepts </span> </a> <nav class=md-nav aria-label="Apache Flink Kubernetes Operator Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#confluent-for-kubernetes-operator-cfk class=md-nav__link> <span class=md-ellipsis> Confluent for Kubernetes Operator (CFK) </span> </a> </li> <li class=md-nav__item> <a href=#confluent-manager-for-flink-cmf class=md-nav__link> <span class=md-ellipsis> Confluent Manager for Flink (CMF) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#custom-resources class=md-nav__link> <span class=md-ellipsis> Custom Resources </span> </a> <nav class=md-nav aria-label="Custom Resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#apache-flink-specific-custom-resources class=md-nav__link> <span class=md-ellipsis> Apache Flink specific custom resources </span> </a> </li> <li class=md-nav__item> <a href=#confluent-manager-for-flink-and-fko class=md-nav__link> <span class=md-ellipsis> Confluent Manager for Flink and FKO </span> </a> </li> <li class=md-nav__item> <a href=#flink-custom-resources class=md-nav__link> <span class=md-ellipsis> Flink Custom Resources </span> </a> </li> <li class=md-nav__item> <a href=#confluent-specific-crs class=md-nav__link> <span class=md-ellipsis> Confluent Specific CRs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#external-components class=md-nav__link> <span class=md-ellipsis> External Components </span> </a> </li> <li class=md-nav__item> <a href=#cfk-installation class=md-nav__link> <span class=md-ellipsis> CFK installation </span> </a> </li> <li class=md-nav__item> <a href=#confluent-manager-for-flink-cmf_1 class=md-nav__link> <span class=md-ellipsis> Confluent Manager for Flink (CMF) </span> </a> </li> <li class=md-nav__item> <a href=#ha-configuration class=md-nav__link> <span class=md-ellipsis> HA configuration </span> </a> </li> <li class=md-nav__item> <a href=#documentations class=md-nav__link> <span class=md-ellipsis> Documentations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#apache-flink-oss class=md-nav__link> <span class=md-ellipsis> Apache Flink OSS </span> </a> <nav class=md-nav aria-label="Apache Flink OSS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deploy-apache-flink-kubernetes-operator class=md-nav__link> <span class=md-ellipsis> Deploy Apache Flink Kubernetes Operator </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#flink-config-update class=md-nav__link> <span class=md-ellipsis> Flink Config Update </span> </a> </li> <li class=md-nav__item> <a href=#flink-session-cluster class=md-nav__link> <span class=md-ellipsis> Flink Session Cluster </span> </a> <nav class=md-nav aria-label="Flink Session Cluster"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#session-deployment class=md-nav__link> <span class=md-ellipsis> Session Deployment </span> </a> </li> <li class=md-nav__item> <a href=#flink-state-snapshot class=md-nav__link> <span class=md-ellipsis> Flink State Snapshot </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#flink-application-deployment class=md-nav__link> <span class=md-ellipsis> Flink Application Deployment </span> </a> <nav class=md-nav aria-label="Flink Application Deployment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#flink-sql-processing class=md-nav__link> <span class=md-ellipsis> Flink SQL processing </span> </a> </li> <li class=md-nav__item> <a href=#flink-application class=md-nav__link> <span class=md-ellipsis> Flink Application </span> </a> </li> <li class=md-nav__item> <a href=#using-minio-for-app-deployment class=md-nav__link> <span class=md-ellipsis> Using MinIO for app deployment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#practices class=md-nav__link> <span class=md-ellipsis> Practices </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=flink-kubernetes-deployment>Flink Kubernetes Deployment<a class=headerlink href=#flink-kubernetes-deployment title="Permanent link">&para;</a></h1> <details class="- info"> <summary>This chapter updates</summary> <ul> <li>Created 10/2024</li> <li>12/24: move some content to hands-on readme, clean content</li> <li>01/25: sql processing section</li> <li>05/25: merge content, simplify, add some details on deployment - fully test k8s deployment on Colima</li> <li>07/25: Update for Confluent Platform v8</li> <li>09/29: Update to diagrams and doc structure.</li> <li>10/12: update to Minio and snapshot / checkpoint configuration</li> <li>10/20: Reorganize content</li> </ul> </details> <p>Apache Flink has defined a Kubernetes Operator (FKO) to deploy and manage custom resources for Flink deployments. Confluent Platform Manager for Flink (CMF) is also deployed on Kubernetes with its own operator, leveraging the FKO. Also as part of the Confluent Platform it is integrated with Confluent Kubernetes Operator (CKO).</p> <p>We assume reader has good <a href=https://kubernetes.io/docs/tutorials/ >understanding and knowledge of Kubernetes</a>, and kubectl.</p> <p>Let start to review the Apache Flink Kubernetes Operator concepts.</p> <h2 id=apache-flink-kubernetes-operator-concepts>Apache Flink Kubernetes Operator Concepts<a class=headerlink href=#apache-flink-kubernetes-operator-concepts title="Permanent link">&para;</a></h2> <p><a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/ >Apache Flink Kubernetes Operator</a>(FKO) acts as a control plane to manage the complete deployment lifecycle of Apache Flink applications. This note summarizes how to use this operator. </p> <p>The <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/ >operator</a> takes care of submitting, savepointing, upgrading and generally managing Flink jobs using the built-in Flink Kubernetes integration. The operator fully automates the entire lifecycle of the job manager, the task managers, and the applications. A FlinkDeployment is a manifest to define what needs to be deployed, and then the FKO manages the deployment by using Kubernetes deployments, pods... It supports query on the custom resources it manages. </p> <figure> <img alt=1 src=../diagrams/fk-operator-hl.drawio.png> <figcaption>Figure 1: Apache Flink Kubernetes Operator to manage Flink Job and Task managers</figcaption> </figure> <p>Failures of Job Manager pod are handled by the Deployment Controller which takes care of spawning a new Job Manager.</p> <p>As any Kubernetes operators, FKO can run <strong>namespace-scoped</strong>, to get multiple versions of the operator in the same Kubernetes cluster, or <strong>cluster-scoped</strong> for highly distributed deployment. The operator maps its custom resources to existing Kubernetes resources of deployments, replica sets, config maps, secrets, service accounts...</p> <p>The following figure represents a simple deployment view of a Flink Cluster, in parallel of a Kafka cluster running on a Kubernetes platform:</p> <figure> <img alt=2 src=../diagrams/k8s-deploy.drawio.png> <figcaption>Figure 2: Flink and Kafka OSS - K8S deployment</figcaption> </figure> <p>The FKO may have two instances running in parallel. A Flink application may run on its own namespace and will be one jb manager and n task managers. The Kafka cluster runs in its own namespace. File services are needed for Flink to persist checkpoints and savepointes. </p> <h3 id=confluent-for-kubernetes-operator-cfk><a href=https://docs.confluent.io/operator/current/overview.html>Confluent for Kubernetes Operator (CFK)</a><a class=headerlink href=#confluent-for-kubernetes-operator-cfk title="Permanent link">&para;</a></h3> <p>The deployments for <a href=https://docs.confluent.io/operator/current/overview.html>Confluent Platform</a> and Confluent Manager for Flink, may look like in the following figure:</p> <figure> <img alt=3 src=../diagrams/cp-cmf-k8s-deploy.drawio.png> <figcaption>Figure 3: K8S deployment</figcaption> </figure> <p><strong>CFK Operator</strong> is the control plane for deploying and managing Confluent in your Kubernetes private cloud environment. It defines custom resource definitions to support Kafka based resources like topics, brokers, connectors. It also defines how to deploy Schema Registry.</p> <p>Once you have a Kubernetes cluster the approach is to first deploy the CKO and then define Kafka resources using manifests:</p> <ul> <li>See <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cfk/Makefile>This makefile</a> and <a href=https://github.com/jbcodeforce/flink-studies/tree/master/deployment/k8s/cfk/README.md>documentation</a>.</li> <li>See the <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cfk/basic-kraft-cluster.yaml>KraftCluster manifest</a> used for all demonstrations in this repository.</li> </ul> <h3 id=confluent-manager-for-flink-cmf>Confluent Manager for Flink (CMF)<a class=headerlink href=#confluent-manager-for-flink-cmf title="Permanent link">&para;</a></h3> <p><strong>Confluent Manager for Flink (CMF)</strong> is a Kubernetes operator, to manage Flink Applications, Environments, Compute pools, Catalogs, we will detail those in a later section.</p> <p>The following figure illustrates the relationships between those operators:</p> <figure> <img alt=4 src=../../techno/diagrams/cp-flink-deployment.drawio.png> <figcaption>Figure 4: The operators playing together</figcaption> </figure> <p>It is important to note that all CR deployments via <code>kubectl</code> go to the CFK with the <code>apiVersion: platform.confluent.io/v1beta1</code>. CRs touching Flink resources are delegated to the CMF operator. While deploying Flink components via the Confluent CLI, the CMF CRDs use different apiVersion. Therefore it is possible to run CMF without CFK. Any CR with <code>cmf.confluent.io/v1</code> as apiVersion needs to be created with confluent CLI, as using <code>kubectl</code> will not work because the CRDs are not known by Kubernetes.</p> <ul> <li>Helpful commands to work on CRDs:</li> </ul> <div class="language-sh highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>kubectl<span class=w> </span>get<span class=w> </span>crds<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>confluent
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>kubectl<span class=w> </span>describe<span class=w> </span>crd<span class=w> </span>kafkatopics.platform.confluent.io<span class=w>  </span>
</span></code></pre></div> <p>The <a href=https://github.com/confluentinc/confluent-Kubernetes-examples>examples in Confluent github</a> provides scenario workflows to deploy and manage Confluent on Kubernetes including Flink and <a href=https://www.confluent.io/blog/resource-management-with-confluent-for-Kubernetes/ >this article: How to Use Confluent for Kubernetes to Manage Resources Outside of Kubernetes</a> covers part of the deployment. </p> <h2 id=custom-resources>Custom Resources<a class=headerlink href=#custom-resources title="Permanent link">&para;</a></h2> <h3 id=apache-flink-specific-custom-resources>Apache Flink specific custom resources<a class=headerlink href=#apache-flink-specific-custom-resources title="Permanent link">&para;</a></h3> <p>A <strong>Flink Application</strong> is any user's program that spawns one or multiple Flink jobs from its <code>main()</code> method and is deploying a JobManager and n Task managers. They may run in their own namespace. </p> <p>The <strong>Flink Kubernetes Operator</strong> is looking at different <code>Flink Deployment</code>, so it can be isolated within its own namespace. When deploying the FKO it is important to <strong>specify the namespaces to watch</strong> for future deployments. The following command modify this list: <div class="language-sh highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>helm<span class=w> </span>upgrade<span class=w> </span>--install<span class=w> </span>cp-flink-Kubernetes-operator<span class=w> </span>--version<span class=w> </span><span class=s2>&quot;~1.120.0&quot;</span><span class=w>  </span>confluentinc/flink-Kubernetes-operator<span class=w> </span>--set<span class=w> </span><span class=nv>watchNamespace</span><span class=o>=</span><span class=s2>&quot;{flink, confluent, el-demo, rental}&quot;</span><span class=w> </span>-n<span class=w> </span>flink
</span></code></pre></div></p> <p>It is important to delete the operator pod and let Kubernetes restarts the FKO pod with the new config.</p> <p>The custom resource definition that describes the schema of a FlinkDeployment is a cluster wide resource. The Operator continuously tracks cluster events relating to the <code>FlinkDeployment</code> and <code>FlinkSessionJob</code> custom resources. <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/concepts/controller-flow/ >The operator control flow is described in this note.</a>. The important points to remember are:</p> <ul> <li>The operator control flow is: 1/ Observes the status of the currently deployed resource. 2/ Validates the new resource spec, 3/ Reconciles any required changes based on the new spec and the observed status.</li> <li>The <strong>Observer</strong> module assesses the current stateus of any deployed Flink resources. </li> <li>Observer is responsible for application upgrade.</li> <li>The job manager is validated via a call to its REST api and the status is recorded in the <code>jobManagerDeploymentStatus</code></li> <li>A Job cannot be in running state without a healthy jobmanager.</li> </ul> <h3 id=confluent-manager-for-flink-and-fko>Confluent Manager for Flink and FKO<a class=headerlink href=#confluent-manager-for-flink-and-fko title="Permanent link">&para;</a></h3> <p><a href=https://docs.confluent.io/platform/current/flink/installation/overview.html#install-and-upgrade-cmf-long>Confluent Manager for Apache Flink®</a> (CMF) manages a fleet of Flink Applications (cluster) across multiple <code>Environments</code>. CP Console is integrated with CMF. CMF exposes a REST API and cli integration for managing Flink statements.</p> <p>CMF integrates with FKO to support Flink native custom resources. The following figure illustrates the current (Oct 2025) configuration of Flink solution deployment using the different CRs apiVersion.</p> <figure> <img alt=5 src=../diagrams/cmf-cko.drawio.png> <figcaption>Figure 5: CFK, CMF and CKO</figcaption> </figure> <ul> <li>Flink Environments can be created with Manifests or using the Confluent CLI. The metadata is persisted in an embedded database. The 'Environment' concept is to group multiple Flink applications together. This is an isolation layer for RBAC, and to define Flink Configuration cross compute pools and applications deployed within an environment. Flink Configuration may include common observability and checkpointing storage (HDFS or S3) definitions. <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cmf/flink-dev-env.yaml>See one definition of FlinkEnvironment</a>.</li> <li>a REST API supports all the external integration to the operator. <strong>Confluent Control Center</strong> and the <code>confluent</code> cli are using this end point.</li> <li>CMF manages FlinkDeployment resources internally</li> <li><strong>Confluent For Kubernetes</strong> is the Confluent operator to manage Kafka resources, but it supports the deployment of FlinkEnvironment and an "adapted" FlinkApplication (to reference an Environment) so kubectl command can access this operator for confluent platform CRs ( <code>apiVersion: platform.confluent.io/v1beta1</code>).</li> </ul> <p>It is still possible to do pure OSS FlinkDeployment CRs but this strongly not recommended to leverage the full power of Confluent Platform and get Confluent Support.</p> <p>Let review the Kubernetes custom resources for Flink.</p> <h3 id=flink-custom-resources>Flink Custom Resources<a class=headerlink href=#flink-custom-resources title="Permanent link">&para;</a></h3> <p>Once the Flink for Kubernetes Operator is running, we can submit jobs using <code>FlinkDeployment</code> (for Flink Application or for Job manager and task manager for session cluster) and <code>FlinkSessionJob</code> Custom Resources for Session. The following figure represents those concepts: </p> <figure> <img alt=6 src=../diagrams/fko-cr.drawio.png> <caption>FKO main Custom Resources Definitions</capture> </figure> <p>On the left, a <code>FlinkSessionJob</code> references an existing FlinkDeployment as multiple session jobs can run into the same Flink cluster. The <code>job</code> declaration specifies the code to run with its specific configuration. While on the right, the application mode, has the job definition as part of the FlinkDeployment, as the JobManager and TaskManager mininum resource requirements.</p> <p>The <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/custom-resource/reference/ >Apache Flink FlinkDeployment spec is here</a> and is used to define Flink application (will have a job section) or session cluster (only job and task managers configuration).</p> <p>It is important to note that <code>FlinkDeployment</code> and <code>FlinkApplication</code> CRDs have a podTemplate, so ConfigMap(s) and Secret(s) can be used to configure environment variables for the flink app. (Be sure to keep the container name as <code>flink-main-container</code>)</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class=nt>podTemplate</span><span class=p>:</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-main-container</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>          </span><span class=nt>envFrom</span><span class=p>:</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>            </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>configMapRef</span><span class=p>:</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-app-cm</span>
</span></code></pre></div> <h3 id=confluent-specific-crs>Confluent Specific CRs<a class=headerlink href=#confluent-specific-crs title="Permanent link">&para;</a></h3> <p><a href=https://docs.confluent.io/operator/current/co-api.html>First an important document to read: The Operator API references.</a></p> <p>Confluent Managed for Flink manages Flink application mode only and is using its own CRDs to define <code>FlinkEnvironment</code> and <code>FlinkApplication</code>. <a href=https://docs.confluent.io/operator/current/co-manage-flink.html#create-a-af-application>The CRDs are defined here</a>. To be complete, it also define KafkaCatalog and ComputePool CRDs to map the same concepts introduced by Confluent Cloud.</p> <ul> <li>The new CRs for Environment, Application, Compute pool, and Flink Catalog:</li> </ul> <figure> <img alt=7 src=../diagrams/cmf-cr.drawio.png> <caption>Confluent Manager for Flink - Custom Resources Definitions</capture> </figure> <ul> <li>An <a href=https://docs.confluent.io/operator/current/co-manage-flink.html#create-a-af-environment>FlinkEnvironment</a> define access control to flink resources and may define FlinkConfigurations cross applications. Environment level has precedence over Flink configuration for individual Flink applications. See <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cmf/flink-dev-env.yaml>one example in deployment/k8s/cmf</a>. <div class="language-yaml highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">platform.confluent.io/v1beta1</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">FlinkEnvironment</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-env</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">confluent</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>  </span><span class=nt>kubernetesNamespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">el-demo</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>  </span><span class=nt>flinkApplicationDefaults</span><span class=p>:</span><span class=w> </span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>      </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-env</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>      </span><span class=nt>flinkConfiguration</span><span class=p>:</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w>        </span><span class=nt>taskmanager.numberOfTaskSlots</span><span class=p>:</span><span class=w> </span><span class=s>&#39;1&#39;</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w>        </span><span class=nt>state.backend.type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rocksdb</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=w>        </span><span class=nt>state.checkpoints.dir</span><span class=p>:</span><span class=w> </span><span class=s>&#39;s3a://flink/checkpoints&#39;</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=w>        </span><span class=nt>state.savepoints.dir</span><span class=p>:</span><span class=w> </span><span class=s>&#39;s3a://flink/savepoints&#39;</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=w>        </span><span class=nt>state.backend.incremental</span><span class=p>:</span><span class=w> </span><span class=s>&#39;true&#39;</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=w>        </span><span class=nt>state.backend.rocksdb.use-bloom-filter</span><span class=p>:</span><span class=w> </span><span class=s>&#39;true&#39;</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=w>        </span><span class=nt>state.checkpoints.num-retained</span><span class=p>:</span><span class=w> </span><span class=s>&#39;3&#39;</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=w>        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=w>      </span><span class=nt>podTemplate</span><span class=p>:</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=w>        </span><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-pod-template</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=w>        </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=w>          </span><span class=nt>containers</span><span class=p>:</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-main-container</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=w>            </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=w>            </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">S3_ENDPOINT</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=w>                </span><span class=nt>secretKeyRef</span><span class=p>:</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=w>                  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">minio-s3-credentials</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=w>                  </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">s3.endpoint</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=w>          </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=w>  </span><span class=nt>cmfRestClassRef</span><span class=p>:</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">confluent</span>
</span></code></pre></div></li> </ul> <p>Some important elements to consider are: </p> <ul> <li> <p><code>kubernetesNamespace</code> is the namespace where the Flink deployment(s) will be deployed. So one environment establishes foundations for those Flink applications. It can define default Flink configuration for all applications and add common labels, like specifying the environment name they run in. <code>FlinkApplication</code> is referencing back the Flink Environment which is not what Flink OSS Application does. The last piece is the <code>cmfRestClassRef</code> to reference the Kubernetes object/resource used to define access point to the CMF REST api.</p> </li> <li> <p><code>CMFRestClass</code> defines the client configuration to access CMF Rest APIs. This resource is referenced by other CFK resources (ex FlinkEnvironment, FlinkApplication) to access CMF Rest APIs. In a more advance configuration, this CR defines security like the authentication mechanism and mTLS to access the REST api. <div class="language-yaml highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">platform.confluent.io/v1beta1</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CMFRestClass</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">confluent</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>  </span><span class=nt>cmfRest</span><span class=p>:</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http://cmf-service.confluent.svc.cluster.local</span>
</span></code></pre></div></p> </li> <li> <p><a href=https://docs.confluent.io/platform/current/flink/get-started/get-started-application.html#step-2-deploy-af-jobs><code>FlinkApplication</code></a> in the context of Confluent Manager for Flink is the same as Flink OSS but it supports references to Environment and to the CMFRestClass. Every application runs on its own cluster, providing isolation between all applications.</p> </li> <li><strong>Service Account</strong>: Service accounts provide a secure way for applications (like Flink jobs deployed via CMF) to interact with Confluent Cloud resources (e.g., Kafka clusters, Schema Registry) without relying on individual user credentials. Service accounts are central to the RBAC system. Need one service account per application or most likely per environment. The SA, cluster role, role and the role bindings need to be defined in the target namespace where the Flink app will be deployed. <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/external-lookup/flink/k8s/rbac.yaml>See this example for one application</a> or <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/json-transformation>this one based on Table API</a></li> <li><strong><a href=https://docs.confluent.io/platform/current/flink/configure/catalog.html#create-a-catalog>KafkaCatalog</a></strong> is used to expose Kafka Topics as Tables for Flink. This CRD defines a Kafka Catalog object to connect to Kafka Cluster(s) and Schema Registry. Each referenced Kafka Cluster is mapped as a Database. See <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/external-lookup/flink/k8s/kafka-catalog-cmf.json>the kafka catalog example in external lookup demo</a> or <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/json-transformation/cp-flink/k8s/kafka-catalog-cmf.json>rental demo</a></li> <li><strong><a href=https://docs.confluent.io/platform/current/flink/configure/compute-pools.html>ComputePools</a></strong> are used in the context of Flink SQL to execute SQL queries or statements. The ComputePool will only be used when the statement is deployed which happens after the compilation. It is a second level of Flink configuration for Flink cluster settings. See <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/external-lookup/flink/k8s/compute-pool-cmf.json>the kafka catalog example in external lookup demo</a>. One important element is to specify the <code>image</code> attribute to referent a flink with SQL like <code>confluentinc/cp-flink-sql:1.19-cp1</code>. <a href=https://hub.docker.com/u/confluentinc>See docker hub for last tags.</a></li> </ul> <p>The configuration flexibility:</p> <ul> <li>FlinkConfiguration defined at the environment level can apply to all compute pools of this environment, and applications</li> <li>Compute pool configuration can apply to all SQL statements executed within the compute pool</li> <li>Flink Application has its own configuration, knowing that an application can be done with DataStream, or TableAPI.</li> </ul> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <p>The Components to install for each deployment approach:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Confluent Platform</label><label for=__tabbed_1_2>Open Source Approach</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>In the context of a Confluent Platform deployment, the components to install are represented in the following figure from bottom to higher layer:</p> <p><img alt src=../diagrams/cp_comp_to_deploy.drawio.png></p> </div> <div class=tabbed-block> <p>For an equivalent open source the components are:</p> <p><img alt src=../diagrams/oss_comp_to_deploy.drawio.png></p> </div> </div> </div> <h3 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h3> <p>Any Kubernetes deployment should include the following pre-requisites:</p> <ul> <li><a href=https://Kubernetes.io/docs/tasks/tools/ >kubectl</a> </li> <li>A Kubernetes cluster. <a href=https://github.com/abiosoft/colima>Colima</a> for local Kubernetes. See start colima with <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/start_colima.sh>deployment/k8s/start_colima.sh</a> or <code>make start_colima</code> under deployment/k8s folder.</li> <li> <p>Be sure to have helm cli installed: (<a href=https://helm.sh/docs/intro/install/ >see installation instructions</a>) <div class="language-sh highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># for mac</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>brew<span class=w> </span>install<span class=w> </span>helm
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=c1># or </span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>brew<span class=w> </span>upgrade<span class=w> </span>helm
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=c1># for WSL2 - ubuntu</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>helm
</span></code></pre></div></p> </li> <li> <p>Install <a href=https://docs.confluent.io/confluent-cli/current/install.html#install-confluent-cli>Confluent CLI</a> or update existing CLI with: <div class="language-sh highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>confluent<span class=w> </span>update
</span></code></pre></div></p> </li> </ul> <h4 id=colima-playground>Colima playground<a class=headerlink href=#colima-playground title="Permanent link">&para;</a></h4> <p>See the <a href="https://github.com/abiosoft/colima?tab=readme-ov-file#installation">Colima installation instructions.</a></p> <ul> <li>Start a Kubernetes cluster, using one of the following options: <div class="language-sh highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>colima<span class=w> </span>start<span class=w> </span>--Kubernetes
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=c1># or under deployment/k8s folder</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>./start_colima.sh
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># or using make under deployment/k8s</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>make<span class=w> </span>start_colima
</span></code></pre></div></li> </ul> <h3 id=external-components>External Components<a class=headerlink href=#external-components title="Permanent link">&para;</a></h3> <p>The certificate manager and minio operator may be deploy in one command under <code>deployment/k8s</code>: <div class="language-sh highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>make<span class=w> </span>deploy
</span></code></pre></div></p> <h4 id=certificate-manager>Certificate manager<a class=headerlink href=#certificate-manager title="Permanent link">&para;</a></h4> <ul> <li> <p><a href=https://github.com/cert-manager/cert-manager/releases>See certificate manager current releases</a>, and update the CERT_MGR_VERSION=v1.18.1 in the <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/Makefile>Makefile</a>, then run the command: <div class="language-sh highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>make<span class=w> </span>deploy_cert_manager
</span></code></pre></div></p> </li> <li> <p>Which is doing: <div class="language-sh highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>kubectl<span class=w> </span>create<span class=w> </span>-f<span class=w> </span>https://github.com/jetstack/cert-manager/releases/download/v1.18.1/cert-manager.yaml
</span></code></pre></div></p> </li> <li> <p>Verify deployment with <code>sh kubeclt get pods -n cert-manager # or make verify_cert_manager</code></p> </li> </ul> <h4 id=using-minio>Using MinIO<a class=headerlink href=#using-minio title="Permanent link">&para;</a></h4> <p>MinIO is an object storage solution that provides an Amazon Web Services S3-compatible API and supports all core S3 features, on k8s. It may be used for Flink checkpoint and snapshot persistenace, or when deploying application jar file to Flink, as a file storage.</p> <ul> <li> <p>First be sure to have <a href=https://min.io/docs/minio/linux/reference/minio-mc.html#quickstart>the MinIO CLI</a> installed. <div class="language-sh highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>brew<span class=w> </span>install<span class=w> </span>minio/stable/mc
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=c1># or to upgrade to a new version</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>brew<span class=w> </span>upgrade<span class=w> </span>minio/stable/mc
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># Verify installation</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>mc<span class=w> </span>--help
</span></code></pre></div></p> <p><a href=https://min.io/docs/minio/linux/reference/minio-mc.html>mc cli command summary</a></p> </li> <li> <p>Deploy Minio operator under <code>minio-dev</code> namespace, using `Make <div class="language-sh highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>make<span class=w> </span>deploy_minio
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>make<span class=w> </span>verify_minio
</span></code></pre></div></p> </li> <li> <p>Access MinIO S3 API and Console <div class="language-sh highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>kubectl<span class=w> </span>port-forward<span class=w> </span>pod/minio<span class=w> </span><span class=m>9000</span><span class=w> </span><span class=m>9090</span><span class=w> </span>-n<span class=w> </span>minio-dev
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=c1># or</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>make<span class=w> </span>port_forward_minio_console
</span></code></pre></div></p> </li> <li> <p>Log in to the Console with the credentials <code>minioadmin | minioadmin</code></p> </li> <li>Setup a minio client with credential saved to $HOME/.mc/config.json <div class="language-sh highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>mc<span class=w> </span><span class=nb>alias</span><span class=w> </span><span class=nb>set</span><span class=w> </span>dev-minio<span class=w> </span>http://localhost:9000<span class=w> </span>minioadmin<span class=w> </span>minioadmin
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=c1># make a bucket</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>mc<span class=w> </span>mb<span class=w> </span>dev-minio/flink
</span></code></pre></div></li> </ul> <h3 id=cfk-installation>CFK installation<a class=headerlink href=#cfk-installation title="Permanent link">&para;</a></h3> <p><a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cfk/Makefile>See this Makefile</a> and <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cfk/README.md>Readme</a></p> <p><a href=https://docs.confluent.io/operator/current/overview.html>See the Confluent Platform product installation documentation</a> for details. We can summarize as: </p> <ul> <li>The deployment leverages Kubernetes native API to configure, deploy, and manage Kafka cluster, Connect workers, Schema Registry, Confluent Control Center, Confluent REST Proxy and application resources such as topics.</li> <li> <p>The following diagram illustrates those components in one namespace. <figure markdown=span> <img alt src=../diagrams/cp-comps-k8s.drawio.png> <caption>Confluent Platform Components - k8s deployment</caption> </figure></p> </li> <li> <p>Under the <a href=https://github.com/jbcodeforce/flink-studies/tree/master/deployment/k8s/cfk>deployment/k8s/cfk</a> folder, run <code>make deploy</code> which will do the following operations:</p> <ul> <li>Create a namespace for Confluent products deployment. By default, it deploys Confluent Platform in the namespaced deployment, and it manages Confluent Platform components in this namespace . </li> <li>Add Confluent Platform <strong>Helm</strong> repositories</li> <li>Deploy Confluent Kafka Broker using one Kraft controller, one to three brokers, the new Confluent Center Console, with REST api and Schema Registry. <div class="language-sh highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=w>      </span>NAME<span class=w>                                  </span>READY<span class=w>   </span>STATUS<span class=w>      </span>RESTARTS<span class=w>          </span>AGE
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>confluent-operator-764dbdf6f9-6f7gx<span class=w>   </span><span class=m>1</span>/1<span class=w>     </span>Running<span class=w>     </span><span class=m>158</span><span class=w> </span><span class=o>(</span>5h41m<span class=w> </span>ago<span class=o>)</span><span class=w>   </span>89d
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>controlcenter-ng-0<span class=w>                    </span><span class=m>3</span>/3<span class=w>     </span>Running<span class=w>     </span><span class=m>13</span><span class=w> </span><span class=o>(</span>5h41m<span class=w> </span>ago<span class=o>)</span><span class=w>    </span>32d
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>kafka-0<span class=w>                               </span><span class=m>1</span>/1<span class=w>     </span>Running<span class=w>     </span><span class=m>4</span><span class=w> </span><span class=o>(</span>5h41m<span class=w> </span>ago<span class=o>)</span><span class=w>     </span>32d
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>kraftcontroller-0<span class=w>                     </span><span class=m>1</span>/1<span class=w>     </span>Running<span class=w>     </span><span class=m>4</span><span class=w> </span><span class=o>(</span>5h41m<span class=w> </span>ago<span class=o>)</span><span class=w>     </span>32d
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>schemaregistry-0<span class=w>                      </span><span class=m>1</span>/1<span class=w>     </span>Running<span class=w>     </span><span class=m>7</span><span class=w> </span><span class=o>(</span>5h41m<span class=w> </span>ago<span class=o>)</span><span class=w>     </span>32d
</span></code></pre></div></li> <li> <p>The console may be accessed via port-forwarding: <div class="language-sh highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>kubectl<span class=w> </span>-n<span class=w> </span>confluent<span class=w> </span>port-forward<span class=w> </span>svc/controlcenter-ng<span class=w> </span><span class=m>9021</span>:9021<span class=w> </span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>chrome<span class=w> </span>localhost:9021
</span></code></pre></div></p> <p><img alt src=../images/cp-console.png></p> </li> </ul> </li> <li> <p>See <a href=https://docs.confluent.io/platform/current/installation/versions-interoperability.html#cp-af-compat>Confluent Platform releases information.</a></p> </li> </ul> <h3 id=confluent-manager-for-flink-cmf_1><a href=https://docs.confluent.io/operator/current/co-deploy-cp.html#co-deploy-cp>Confluent Manager for Flink (CMF)</a><a class=headerlink href=#confluent-manager-for-flink-cmf_1 title="Permanent link">&para;</a></h3> <p>Updated 10.18.2025: For CFK version 2.0.3 and CP v8.0.2</p> <p><a href=https://github.com/jbcodeforce/flink-studies/tree/master/deployment/k8s/cmf/Makefile>See the Makefile under deployment/k8s/cmf</a> which includes a set of targets to simplify the deployment. <a href=https://docs.confluent.io/platform/current/flink/get-started/get-started-application.html#step-1-install-cmf-long>See Confluent Manager for Flink product documentation</a> for deeper information. The following steps are a summary of what should be done.</p> <ul> <li>Install Confluent Manager for Flink operator, under <code>deployment/k8s/cmf</code> <div class="language-sh highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>make<span class=w> </span><span class=nb>help</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>make<span class=w> </span>deploy
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>make<span class=w> </span>status
</span></code></pre></div></li> </ul> <p>See <a href=#flink-application-deployment>deploy application section for SQL or Java app deployment</a></p> <hr> <h3 id=ha-configuration>HA configuration<a class=headerlink href=#ha-configuration title="Permanent link">&para;</a></h3> <p>Within Kubernetes, we can enable Flink HA in the ConfigMap of the cluster configuration that will be shared with deployments:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=w>  </span><span class=nt>flinkConfiguration</span><span class=p>:</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>    </span><span class=nt>taskmanager.numberOfTaskSlots</span><span class=p>:</span><span class=w> </span><span class=s>&quot;2&quot;</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span><span class=nt>state.backend</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rockdb</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>    </span><span class=nt>state.savepoints.dir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">file:///flink-data/savepoints</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>    </span><span class=nt>state.checkpoints.dir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">file:///flink-data/checkpoints</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=w>    </span><span class=nt>high-availability.type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Kubernetes</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>    </span><span class=nt>high-availability.storageDir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">file:///flink-data/ha</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>    </span><span class=nt>job.autoscaler.enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div> <p>This configuration settings is supported via FKO. <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/operations/configuration/ >See product documentation</a>, and the <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/operations/configuration/#autoscaler-configuration>autoscaler section</a> for deeper parameter explanations. The Flink autoscaler monitors the number of unprocessed records in the input (pending records), and will allocate more resources to absorb the lag. It adjusts parallelism at the flink operator level within the DAG. </p> <p>JobManager metadata is persisted in the file system specified by <code>high-availability.storageDir</code> . This <code>storageDir</code> stores all metadata needed to recover a JobManager failure.</p> <p>JobManager Pods, that crashed, are restarted automatically by the Kubernetes scheduler, and as Flink persists metadata and the job artifacts, it is important to mount pv to the expected paths.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=nt>podTemplate</span><span class=p>:</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>  </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>    </span><span class=nt>containers</span><span class=p>:</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-main-container</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/flink-data</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-volume</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-volume</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>      </span><span class=nt>hostPath</span><span class=p>:</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=w>        </span><span class=c1># directory location on host</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/flink</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>        </span><span class=c1># this field is optional</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Directory</span>
</span></code></pre></div> <p>Recall that <code>podTemplate</code> is a base declaration common for job and task manager pods. Can be overridden by the jobManager and taskManager pod template sub-elements (spec.taskManager.podTemplate). The previous declaration will work for local k8s with hostPath access, for Kubernetes cluster with separate storage class then the volume declaration is:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=nt>volumes</span><span class=p>:</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-volume</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>    </span><span class=nt>persistenceVolumeClaim</span><span class=p>:</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>      </span><span class=nt>claimName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-pvc</span>
</span></code></pre></div> <p>podTemplate can include nodeAffinity to allocate taskManager to different node characteristics:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=w>  </span><span class=nt>podTemplate</span><span class=p>:</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=w>      </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=w>        </span><span class=nt>affinity</span><span class=p>:</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=w>          </span><span class=nt>nodeAffinity</span><span class=p>:</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>            </span><span class=nt>requiredDuringSchedulingIgnoredDuringExecution</span><span class=p>:</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=w>              </span><span class=nt>nodeSelectorTerms</span><span class=p>:</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=w>                </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>matchExpressions</span><span class=p>:</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=w>                    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cfk-cr</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=w>                      </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">In</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=w>                      </span><span class=nt>values</span><span class=p>:</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=w>                        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink</span>
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=w>        </span><span class=nt>tolerations</span><span class=p>:</span>
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cfk-cr</span>
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=w>            </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Equal</span>
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a><span class=w>            </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink</span>
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a><span class=w>            </span><span class=nt>effect</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">NoSchedule</span>
</span></code></pre></div> <h3 id=documentations>Documentations<a class=headerlink href=#documentations title="Permanent link">&para;</a></h3> <ul> <li><a href=https://docs.confluent.io/platform/current/flink/get-started-cpf.html>Confluent Platform for Flink has another operator</a> integrated with FKO. <a href=../../techno/cp-flink/ >See my CP Flink summary</a>.</li> <li><a href=https://docs.confluent.io/operator/current/co-prepare.html>Confluent Flink operator documentation</a></li> <li><a href=https://nightlies.apache.org/flink/flink-docs-release-1.20/docs/deployment/resource-providers/standalone/Kubernetes/ >Getting started with Flink OSS Standalone Kubernetes Setup.</a></li> <li><a href=https://nightlies.apache.org/flink/flink-docs-release-1.20/docs/deployment/resource-providers/native_Kubernetes/ >Apache Flink Native Kubernetes deployment.</a></li> <li><a href=https://github.com/confluentinc/confluent-demo>A Confluent Platform demonstration git repo: confluentinc/confluent-demo</a></li> </ul> <hr> <ul> <li>Next steps is to upload jar files for the different applications to deploy, or data sets for SQL table. See <a href=#flink-application-deployment>application section</a>.</li> </ul> <hr> <p>TO UPDATE </p> <h4 id=durable-storage>Durable Storage<a class=headerlink href=#durable-storage title="Permanent link">&para;</a></h4> <p>Durable storage is used to store consistent checkpoints of the Flink state. Review <a href=../../concepts/#state-management>the state management</a> section in the concept chapter. The checkpoints are saved to object storage <a href=https://docs.confluent.io/platform/current/flink/how-to-guides/checkpoint-s3.html>compatible with S3</a>, or HDFS protocol. The FlinkConfiguration can be set at the Application, ComputePool or Environment level.</p> <p>Two important elements to configure: 1. the environment variable ENABLE_BUILT_IN_PLUGINS 1. The <code>state.checkpoints.dir</code> to the location of S3 bucket.</p> <p>The following is a configuration using minio and the presto S3FileSystem which is a specific implementation (created by Presto) of the file system interface within Apache Flink. (See the <a href=https://nightlies.apache.org/flink/flink-docs-master/api/java/org/apache/flink/fs/s3presto/S3FileSystemFactory.html>S3FileSystemFactory class</a>). </p> <div class="language-json highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=nt>&quot;flinkConfiguration&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=w>        </span><span class=nt>&quot;pipeline.operator-chaining.enabled&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;false&quot;</span><span class=p>,</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=w>        </span><span class=nt>&quot;execution.checkpointing.interval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;10s&quot;</span><span class=p>,</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=w>        </span><span class=nt>&quot;taskmanager.numberOfTaskSlots&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;4&quot;</span><span class=p>,</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=w>        </span><span class=nt>&quot;fs.s3.impl&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;org.apache.flink.fs.s3presto.S3FileSystem&quot;</span><span class=p>,</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>        </span><span class=nt>&quot;presto.s3.endpoint&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;http://minio.minio-dev.svc.cluster.local:9000&quot;</span><span class=p>,</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=w>        </span><span class=nt>&quot;presto.s3.path.style.access&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;true&quot;</span><span class=p>,</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=w>        </span><span class=nt>&quot;presto.s3.connection.ssl.enabled&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;false&quot;</span><span class=p>,</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=w>        </span><span class=nt>&quot;presto.s3.access-key&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;admin&quot;</span><span class=p>,</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=w>        </span><span class=nt>&quot;presto.s3.secret-key&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;admin123&quot;</span><span class=p>,</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=w>        </span><span class=nt>&quot;state.checkpoints.dir&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;s3://flink/stateful-flink/checkpoints&quot;</span><span class=p>,</span>
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=w>        </span><span class=nt>&quot;state.savepoints.dir&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;s3://flink/stateful-flink/savepoints&quot;</span><span class=p>,</span>
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=w>        </span><span class=nt>&quot;state.checkpoints.interval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;10000&quot;</span><span class=p>,</span>
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=w>        </span><span class=nt>&quot;state.checkpoints.timeout&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;600000&quot;</span>
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a>
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a><span class=w>      </span><span class=p>},</span>
</span></code></pre></div> <p>For Minio settings:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=w>  </span><span class=nt>s3.endpoint</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http://minio.minio-dev.svc.cluster.local:9000</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=w>  </span><span class=nt>s3.path.style.access</span><span class=p>:</span><span class=w> </span><span class=s>&quot;true&quot;</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=w>  </span><span class=nt>s3.connection.ssl.enabled</span><span class=p>:</span><span class=w> </span><span class=s>&quot;false&quot;</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>  </span><span class=nt>s3.access-key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">minioadmin</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>  </span><span class=nt>s3.secret-key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">minioadmin</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=w>  </span><span class=nt>state.checkpoints.dir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">s3://flink/stateful-flink/checkpoints</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=w>  </span><span class=nt>state.savepoints.dir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">s3://flink/stateful-flink/savepoints</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>  </span><span class=nt>state.checkpoints.interval</span><span class=p>:</span><span class=w> </span><span class=s>&quot;10000&quot;</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=w>  </span><span class=nt>state.checkpoints.timeout</span><span class=p>:</span><span class=w> </span><span class=s>&quot;600000&quot;</span>
</span></code></pre></div> <p>TO BE CONTINUED</p> <p>A RWX, shared PersistentVolumeClaim (PVC) for the Flink JobManagers and TaskManagers provides persistence for stateful checkpoint and savepoint of Flink jobs. </p> <figure> <img alt=4 src=../diagrams/storage.drawio.png> </figure> <p>A flow is a packaged as a jar, so developers need to define a docker image with the Flink API and any connector jars. Example of <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/e-com-sale/flink-app/Dockerfile>Dockerfile</a> and <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/e-com-sale/k8s/cmf_app_deployment.yaml>FlinkApplication manifest</a>.</p> <p>Also one solution includes using MinIO to persist application jars.</p> <h2 id=apache-flink-oss>Apache Flink OSS<a class=headerlink href=#apache-flink-oss title="Permanent link">&para;</a></h2> <ul> <li> <p>Add the Apache Flink <strong>Helm</strong> repositories: <div class="language-sh highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>helm<span class=w> </span>repo<span class=w> </span>add<span class=w> </span>flink-operator-repo<span class=w> </span>https://downloads.apache.org/flink/flink-Kubernetes-operator-1.11.0
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=c1># Verify help repo entries exist</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>helm<span class=w> </span>repo<span class=w> </span>list
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=c1># Be sure to change the repo as the URL may not be valid anymore</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>helm<span class=w> </span>repo<span class=w> </span>remove<span class=w>  </span>flink-operator-repo
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=c1># try to update repo content</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>helm<span class=w> </span>repo<span class=w> </span>update
</span></code></pre></div></p> <p>See <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/ >Apache Flink Operator documentation</a> </p> </li> </ul> <h3 id=deploy-apache-flink-kubernetes-operator>Deploy Apache Flink Kubernetes Operator<a class=headerlink href=#deploy-apache-flink-kubernetes-operator title="Permanent link">&para;</a></h3> <p>The <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/try-flink-Kubernetes-operator/quick-start/ >Apache flink Kubernetes operator product documentation</a> lists the setup steps.</p> <ul> <li>Get the <a href=https://downloads.apache.org/flink/ >list of Apache Flink releases and tags here</a> </li> <li>To get access to k8s deployment manifests and a Makefile to simplify deployment, of Apache Flink, or Confluent Platform on k8s (local colima or minikube) see <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/fink-oss/README.md>the deployment/k8s/flink-oss folder</a>. <div class="language-sh highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>make<span class=w> </span>prepare
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>make<span class=w> </span>verify_flink
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>make<span class=w> </span>deploy_basic_flink_deployment<span class=w>  </span>
</span></code></pre></div></li> <li><a href=http://localhost:8081>Access Flink UI</a></li> <li>Mount a host folder as a PV to access data or SQL scripts, using hostPath.</li> </ul> <h2 id=flink-config-update>Flink Config Update<a class=headerlink href=#flink-config-update title="Permanent link">&para;</a></h2> <ul> <li> <p>If a write operation fails when the pod creates a folder or updates the Flink config, verify the following:</p> <ul> <li>Assess PVC and R/W access. Verify PVC configuration. Some storage classes or persistent volume types may have restrictions on directory creation</li> <li>Verify security context for the pod. Modify the pod's security context to allow necessary permissions.</li> <li>The podTemplate can be configured at the same level as the task and job managers so any mounted volumes will be available to those pods. See <a href=https://github.com/apache/flink-Kubernetes-operator/blob/main/examples/basic-reactive.yaml>basic-reactive.yaml</a> from Flink Operator examples.</li> </ul> </li> </ul> <p><a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/pvc.yaml>See PVC and PV declarations</a></p> <h2 id=flink-session-cluster>Flink Session Cluster<a class=headerlink href=#flink-session-cluster title="Permanent link">&para;</a></h2> <p>For Session cluster, there is no jobSpec. See <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/basic-job-task-mgrs.yaml>this deployment definition</a>. Once a cluster is defined, it has a name and can be referenced to submit SessionJobs.</p> <p>A SessionJob is executed as a long-running Kubernetes Deployment. We may run multiple Flink jobs on a Session cluster. Each job needs to be submitted to the cluster after the cluster has been deployed. To deploy a job, we need at least three components:</p> <ul> <li>a Deployment which runs a JobManager</li> <li>a Deployment for a pool of TaskManagers</li> <li>a Service exposing the JobManager’s REST and UI ports</li> </ul> <p>For a deployment select the execution mode: <code>application, or session</code>. For production it is recommended to deploy in <code>application</code> mode for better isolation, and using a cloud native approach. We can just build a dockerfile for our application using the Flink jars.</p> <h3 id=session-deployment>Session Deployment<a class=headerlink href=#session-deployment title="Permanent link">&para;</a></h3> <p>Flink has a <a href=https://github.com/apache/flink/blob/master/flink-examples/ >set of examples</a> like the <a href=https://github.com/apache/flink/blob/master/flink-examples/flink-examples-streaming/src/main/java/org/apache/flink/streaming/examples/windowing/TopSpeedWindowing.java>Car top speed computation with simulated record</a>. As this code is packaged in a jar available in maven repository, we can declare a job session.</p> <p>Deploy a config map to define the <code>log4j-console.properties</code> and other parameters for Flink (<code>flink-conf.yaml</code>)</p> <p>The diagram below illustrates the standard deployment of a job on k8s with session mode:</p> <p><img alt=1 src=https://ci.apache.org/projects/flink/flink-docs-release-1.14/fig/FlinkOnK8s.svg></p> <p><em>src: apache Flink site</em></p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink.apache.org/v1beta1</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">FlinkSessionJob</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">car-top-speed-job</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=w>  </span><span class=nt>deploymentName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flink-session-cluster</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>  </span><span class=nt>job</span><span class=p>:</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=w>    </span><span class=nt>jarURI</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://repo1.maven.org/maven2/org/apache/flink/flink-examples-streaming_2.12/1.17.2/flink-examples-streaming_2.12-1.17.2-TopSpeedWindowing.jar</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w>    </span><span class=nt>parallelism</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w>    </span><span class=nt>upgradeMode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">stateless</span>
</span></code></pre></div> <p>Before deploying this job, be sure to deploy a session cluster using the following command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># under deployment/k8s</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>basic-job-task-mgrs.yaml<span class=w> </span>
</span></code></pre></div> <p>Once the job is deployed we can see the pod and then using the user interface the job continuously running:</p> <ul> <li> <p>Example of deploying Java based <a href=https://github.com/apache/flink-Kubernetes-operator/blob/main/examples/flink-sql-runner-example/README.md>SQL Runner</a> to interpret a Flink SQL script: package it as docker images, and deploy it with a Session Job. There is a equivalent for Python using <a href=https://nightlies.apache.org/flink/flink-docs-release-1.18/docs/dev/python/overview/ >Pyflink</a>.</p> <ul> <li><a href=https://github.com/jbcodeforce/flink-studies/tree/master/flink-sql-demos/sql-runner>See the ported code for Java</a></li> <li>And for the <a href=https://github.com/jbcodeforce/flink-studies/tree/master/flink-sql-demos/flink-python-sql-runner>Python implementation</a></li> </ul> </li> </ul> <h3 id=flink-state-snapshot>Flink State Snapshot<a class=headerlink href=#flink-state-snapshot title="Permanent link">&para;</a></h3> <p>To help managing snapshots, there is another CR called <a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/custom-resource/reference/#flinkstatesnapshotspec>FlinkStateSnapshot</a></p> <h2 id=flink-application-deployment>Flink Application Deployment<a class=headerlink href=#flink-application-deployment title="Permanent link">&para;</a></h2> <p>There two types of Flink application: the java packaging or the SQL client with open session to the cluster.</p> <h3 id=flink-sql-processing>Flink SQL processing<a class=headerlink href=#flink-sql-processing title="Permanent link">&para;</a></h3> <p>There are multiple choices to run Flink SQL: using the SQL client, or package the SQL scripts in a docker container with the <a href=https://github.com/jbcodeforce/flink-studies/tree/master/code/flink-java/sql-runner>java SQL runner</a> executing the SQL statements from a file, or use the Table API. The application deployment is Java based even if SQL scripts are used for stream processing.</p> <p>With Apache Flink OSS, Flink Session Cluster is the most suitable deployment mode for the SQL Client. This is a long-running Flink cluster (JobManager and TaskManagers) on which you can submit multiple jobs to. The sql client is a long-running, interactive application that submits jobs to an existing cluster.</p> <p>For Confluent Manager For Flink the recommended approach is to use a Flink Application, which per design, is one Job manager with multiple Task managers or use the Flink SQL Shell.</p> <h4 id=confluent-manager-for-flink>Confluent Manager for Flink<a class=headerlink href=#confluent-manager-for-flink title="Permanent link">&para;</a></h4> <p>As seen previously in <strong>Confluent Manager for Flink</strong> the method is to create an <strong>Environment</strong> and <strong>Compute pool</strong> to run the SQL statements in a pool. Those concepts and components are the same as the Confluent Cloud for Flink.</p> <ul> <li> <p>Be sure that the port-forward to the svc/cmf-service is active.</p> </li> <li> <p>Define an environment: <div class="language-sh highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=nb>export</span><span class=w> </span><span class=nv>CONFLUENT_CMF_URL</span><span class=o>=</span>http://localhost:8084
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=c1># be sure to not be connected to confluent cloud, if not do:</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>confluent<span class=w> </span><span class=nb>logout</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=c1># Look at current environment</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>confluent<span class=w> </span>flink<span class=w> </span>environment<span class=w>  </span>list
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=c1># Create new env</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>confluent<span class=w> </span>flink<span class=w> </span>environment<span class=w> </span>create<span class=w> </span>dev<span class=w> </span>--kubernetes-namespace<span class=w> </span>el-demo
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=c1># or under deployment/k8s/cmf</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>make<span class=w> </span>create_flink_env
</span></code></pre></div></p> </li> <li> <p>Define a compute pool (verify current <a href=https://hub.docker.com/r/confluentinc/cp-flink-sql/tags>docker image tag</a>) and see the <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cmf/compute_pool.json>compute_pool.json</a> <div class="language-sh highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>make<span class=w> </span>create_compute_pool
</span></code></pre></div></p> </li> <li> <p>Flink SQL uses the concept of Catalogs to connect to external storage systems. CMF features built-in KafkaCatalogs to connect to Kafka and Schema Registry. A <code>KafkaCatalog</code> exposes Kafka topics as tables and derives their schema from Schema Registry. Define a Flink Catalog as json file: (see <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cmf/kafka_catalog.json>cmf/kafka_catalog.json</a>). The catalog is configured with connection properties for the Kafka and Schema Registry clients. <div class="language-sh highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>make<span class=w> </span>create_kafka_catalog
</span></code></pre></div></p> </li> <li> <p>Define secret to access Kafka Cluster <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cmf/kafka_secret.json>See this secret</a> and <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/cmf/env_secret_mapping.json>the mapping</a> <div class="language-sh highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>make<span class=w> </span>create_kafka_secret
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>make<span class=w> </span>create_env_secret_mapping
</span></code></pre></div></p> </li> <li> <p>Use the confluent cli to start a Flink SQL shell <div class="language-sh highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>confluent<span class=w> </span>--environment<span class=w> </span>dev<span class=w> </span>--compute-pool<span class=w> </span>pool1<span class=w> </span>flink<span class=w> </span>shell<span class=w> </span>--url<span class=w> </span>http://localhost:8084
</span></code></pre></div></p> </li> </ul> <h4 id=apache-flink-oss_1>Apache Flink (OSS)<a class=headerlink href=#apache-flink-oss_1 title="Permanent link">&para;</a></h4> <p>You can run the SQL Client in a couple of ways:</p> <ul> <li>As a separate Docker container: The Flink Docker images include the SQL Client. You can run a container and connect to the JobManager. You will need to mount a volume to persist SQL scripts and other data. <div class="language-sh highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>kubectl<span class=w> </span><span class=nb>exec</span><span class=w> </span>-it<span class=w> </span>&lt;sql-client-pod-name&gt;<span class=w> </span>--<span class=w> </span>/opt/flink/bin/sql-client.sh
</span></code></pre></div></li> </ul> <p>When running the SQL Client as a pod within the same Kubernetes cluster, you can use the internal DNS name of the JobManager service to connect. The format is typically <service-name>.<namespace>.svc.cluster.local</p> <ul> <li>Locally: Download the Flink distribution, extract it, and run the SQL Client from your local machine. <div class="language-sh highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># port forwarding</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>kubectl<span class=w> </span>port-forward<span class=w> </span>svc/&lt;jobmanager-service-name&gt;<span class=w> </span><span class=m>8081</span>:8081
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>./bin/sql-client.sh<span class=w> </span>-s<span class=w> </span>&lt;jobmanager-service-name&gt;:8081
</span></code></pre></div></li> </ul> <h3 id=flink-application>Flink Application<a class=headerlink href=#flink-application title="Permanent link">&para;</a></h3> <p>An <strong>application deployment</strong> must define the job (JobSpec) field with the <code>jarURI</code>, <code>parallelism</code>, <code>upgradeMode</code> one of (stateless/savepoint/last-state) and the desired <code>state</code> of the job (running/suspended). <a href=https://github.com/jbcodeforce/flink-studies/blob/master/deployment/k8s/basic-sample.yaml>See this sample app</a> or the <a href=https://github.com/jbcodeforce/flink-studies/tree/master/e2e-demos/e-com-sale/k8s/cmf_app_deployment.yaml>cmf_app_deployment.yaml</a> in the e-com-sale demonstration.</p> <p>Here is an example of FlinkApplication, the CRD managed by the CMF operator:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmf.confluent.io/v1</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=s>kind:</span><span class=nv> </span><span class=s>FlinkApplication&quot;</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=w>  </span><span class=nt>flinkVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1_19</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">confluentinc/cp-flink:1.19.1-cp2</span><span class=w>  </span><span class=c1># or a custom image based on this one.</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=w>  </span><span class=nt>job</span><span class=p>:</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=w>      </span><span class=nt>jarURI</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">local:///opt/flink/examples/streaming/StateMachineExample.jar</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=w>      </span><span class=c1># For your own deployment, use your own jar</span>
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a><span class=w>      </span><span class=nt>jarURI</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">local:///opt/flink/usrlib/yourapp01.0.0.jar</span>
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=w>      </span><span class=nt>parallelism</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=w>      </span><span class=nt>upgradeMode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">stateless</span>
</span><span id=__span-35-12><a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">running</span>
</span><span id=__span-35-13><a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a><span class=w>  </span><span class=nt>jobManager</span><span class=p>:</span><span class=w> </span>
</span><span id=__span-35-14><a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w> </span>
</span><span id=__span-35-15><a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id=__span-35-16><a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1048m</span>
</span><span id=__span-35-17><a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a><span class=w>  </span><span class=nt>taskManager</span><span class=p>:</span><span class=w> </span>
</span><span id=__span-35-18><a id=__codelineno-35-18 name=__codelineno-35-18 href=#__codelineno-35-18></a><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w> </span>
</span><span id=__span-35-19><a id=__codelineno-35-19 name=__codelineno-35-19 href=#__codelineno-35-19></a><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id=__span-35-20><a id=__codelineno-35-20 name=__codelineno-35-20 href=#__codelineno-35-20></a><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1048m</span>
</span></code></pre></div> <ul> <li><a href=https://docs.confluent.io/operator/current/co-manage-flink.html>See manage Flink app using Confluent for Flink</a></li> </ul> <h4 id=fault-tolerance>Fault tolerance<a class=headerlink href=#fault-tolerance title="Permanent link">&para;</a></h4> <p>For Flink job or application that are stateful and for fault tolerance, it is important to enable checkpointing and savepointing:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=nt>job</span><span class=p>:</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=w>  </span><span class=nt>jarURI</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">local:///opt/flink/examples/streaming/StateMachineExample.jar</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=w>  </span><span class=nt>parallelism</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=w>  </span><span class=nt>upgradeMode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">savepoint</span>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=w>  </span><span class=c1>#savepointTriggerNonce: 0</span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=w>  </span><span class=c1># initialSavepointPath: file:///</span>
</span></code></pre></div> <p>The other upgradeMode is ``</p> <details class="- question"> <summary>How to validate checkpointing?</summary> <p>Checkpointing let Flink to periodically save the state of a job into local storage. Look at the pod name of the task manager and stop it with <code>kubectl delete pod/....</code> Flink should automatically restart the job and recover from the latest checkpoint. Use the Flink UI or CLI to see the job status.</p> </details> <details class="- question"> <summary>How to validate savepointing?</summary> <p>Savepoints are manually triggered snapshots of the job state, which can be used to upgrade a job or to perform manual recovery. To trigger a savepoint we need to set a value into <code>savepointTriggerNonce</code> in the FlinkDeployment descriptor and then apply the changes. Get the location of the save point and then add to the yaml <code>initialSavepointPath</code> to redeploy the applicationL: it will reload its state from the savepoint. There is a custom resource definition (<a href=https://nightlies.apache.org/flink/flink-Kubernetes-operator-docs-main/docs/custom-resource/reference/#flinkstatesnapshotspec>FlinkStateSnapshotSpec</a>) to trigger savepoints. </p> </details> <p><code>flinkConfiguration</code> is a hash map used to define the Flink configuration, such as the task slot, HA and checkpointing parameters.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=w>  </span><span class=nt>flinkConfiguration</span><span class=p>:</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=w>    </span><span class=nt>high-availability.type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">org.apache.flink.Kubernetes.highavailability.KubernetesHaServicesFactory</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>    </span><span class=nt>high-availability.storageDir</span><span class=p>:</span><span class=w> </span><span class=s>&#39;file:///opt/flink/volume/flink-ha&#39;</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>    </span><span class=nt>restart-strategy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">failure-rate</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>    </span><span class=nt>restart-strategy.failure-rate.max-failures-per-interval</span><span class=p>:</span><span class=w> </span><span class=s>&#39;10&#39;</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=w>    </span><span class=nt>restart-strategy.failure-rate.failure-rate-interval</span><span class=p>:</span><span class=w> </span><span class=s>&#39;10</span><span class=nv> </span><span class=s>min&#39;</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=w>    </span><span class=nt>restart-strategy.failure-rate.delay</span><span class=p>:</span><span class=w> </span><span class=s>&#39;30</span><span class=nv> </span><span class=s>s&#39;</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=w>    </span><span class=nt>execution.checkpointing.interval</span><span class=p>:</span><span class=w> </span><span class=s>&#39;5000&#39;</span>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=w>    </span><span class=nt>execution.checkpointing.unaligned</span><span class=p>:</span><span class=w> </span><span class=s>&#39;false&#39;</span>
</span><span id=__span-37-10><a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=w>    </span><span class=nt>state.backend.type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rocksdb</span>
</span><span id=__span-37-11><a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a><span class=w>    </span><span class=nt>state.backend.incremental</span><span class=p>:</span><span class=w> </span><span class=s>&#39;true&#39;</span>
</span><span id=__span-37-12><a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a><span class=w>    </span><span class=nt>state.backend.rocksdb.use-bloom-filter</span><span class=p>:</span><span class=w> </span><span class=s>&#39;true&#39;</span>
</span><span id=__span-37-13><a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=w>    </span><span class=nt>state.checkpoints.dir</span><span class=p>:</span><span class=w> </span><span class=s>&#39;file:///opt/flink/volume/flink-cp&#39;</span>
</span><span id=__span-37-14><a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a><span class=w>    </span><span class=nt>state.checkpoints.num-retained</span><span class=p>:</span><span class=w> </span><span class=s>&#39;3&#39;</span>
</span><span id=__span-37-15><a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a><span class=w>    </span><span class=nt>state.savepoints.dir</span><span class=p>:</span><span class=w> </span><span class=s>&#39;file:///opt/flink/volume/flink-sp&#39;</span>
</span><span id=__span-37-16><a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a><span class=w>    </span><span class=nt>taskmanager.numberOfTaskSlots</span><span class=p>:</span><span class=w> </span><span class=s>&#39;10&#39;</span>
</span><span id=__span-37-17><a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a><span class=w>    </span><span class=nt>table.exec.source.idle-timeout</span><span class=p>:</span><span class=w> </span><span class=s>&#39;30</span><span class=nv> </span><span class=s>s&#39;</span>
</span></code></pre></div> <p>The application jar needs to be in a custom Flink docker image built using the <a href=https://github.com/jbcodeforce/flink-studies/blob/master/e2e-demos/e-com-sale/flink-app/Dockerfile>Dockerfile as in e-com-sale-demo</a>, or uploaded to a MinIO bucket. </p> <p>The following Dockerfile is used for deploying a solution in <strong>application mode</strong>, which packages the Java Flink jars with the app, and any connector jars needed for the integration and starts the <code>main()</code> function.</p> <div class="language-dockerfile highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=k>FROM</span><span class=w> </span><span class=s>confluentinc/cp-flink:1.19.1-cp2</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span><span class=nv>$FLINK_HOME</span>/usrlib
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=k>COPY</span><span class=w> </span>/path/of/my-flink-job-*.jar<span class=w> </span><span class=nv>$FLINK_HOME</span>/usrlib/my-flink-job.jar
</span></code></pre></div> <ul> <li> <p>With Confluent Platform for Flink:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=w>  </span><span class=c1># First be sure the service is expose</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=w>  </span>kubectl<span class=w> </span>port-forward<span class=w> </span>svc/cmf-service<span class=w> </span><span class=m>8080</span>:80<span class=w> </span>-n<span class=w> </span>flink
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=w>  </span><span class=c1># Deploy the app given its deployment</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=w>  </span>confluent<span class=w> </span>flink<span class=w> </span>application<span class=w> </span>create<span class=w> </span>k8s/cmf_app_deployment.yaml<span class=w>  </span>--environment<span class=w> </span><span class=k>$(</span>ENV_NAME<span class=k>)</span><span class=w> </span>--url<span class=w> </span>http://localhost:8080<span class=w> </span>
</span></code></pre></div> </li> </ul> <details class="- info"> <summary>Access to user interface</summary> <p>To forward your jobmanager’s web ui port to local 8081.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>kubectl<span class=w> </span>port-forward<span class=w> </span><span class=si>${</span><span class=nv>flink</span><span class=p>-jobmanager-pod</span><span class=si>}</span><span class=w> </span><span class=m>8081</span>:8081<span class=w> </span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=c1># Or using confluent cli CP for Flink command:</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>confluent<span class=w> </span>flink<span class=w> </span>application<span class=w> </span>web-ui-forward<span class=w> </span><span class=k>$(</span>APP_NAME<span class=k>)</span><span class=w> </span>--environment<span class=w> </span><span class=k>$(</span>ENV_NAME<span class=k>)</span><span class=w> </span>--port<span class=w> </span><span class=m>8081</span><span class=w> </span>--url<span class=w> </span>http://localhost:8080
</span></code></pre></div> <p>And navigate to <a href=http://localhost:8081>http://localhost:8081</a>.</p> </details> <h3 id=using-minio-for-app-deployment>Using MinIO for app deployment<a class=headerlink href=#using-minio-for-app-deployment title="Permanent link">&para;</a></h3> <ul> <li> <p>Upload an application to minio bucket:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>mc<span class=w> </span>cp<span class=w> </span>./target/flink-app-0.1.0.jar<span class=w> </span>dev-minio/flink/flink-app-0.1.0.jar
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>mc<span class=w> </span>ls<span class=w> </span>dev-minio/flink
</span></code></pre></div> </li> <li> <p>Start the application using confluent cli:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>confluent<span class=w> </span>flink<span class=w> </span>application<span class=w> </span>create<span class=w> </span>--environment<span class=w> </span>env1<span class=w> </span>--url<span class=w> </span>http://localhost:8080<span class=w> </span>app-deployment.json
</span></code></pre></div> </li> <li> <p>Open Flink UI:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a>confluent<span class=w> </span>flink<span class=w> </span>application<span class=w> </span>web-ui-forward<span class=w> </span>--environment<span class=w> </span>env1<span class=w> </span>flink-app<span class=w> </span>--url<span class=w> </span>http://localhost:8080
</span></code></pre></div> </li> <li> <p>Produce messages to kafka topic</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=nb>echo</span><span class=w> </span><span class=s1>&#39;message1&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>kubectl<span class=w> </span><span class=nb>exec</span><span class=w> </span>-i<span class=w> </span>-n<span class=w> </span>confluent<span class=w> </span>kafka-0<span class=w> </span>--<span class=w> </span>/bin/kafka-console-producer<span class=w> </span>--bootstrap-server<span class=w> </span>kafka.confluent.svc.cluster.local:9092<span class=w> </span>--topic<span class=w> </span><span class=k>in</span>
</span></code></pre></div> </li> <li> <p>Cleanup</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=c1># the Flink app</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>confluent<span class=w> </span>flink<span class=w> </span>application<span class=w> </span>delete<span class=w> </span>kafka-reader-writer-example<span class=w> </span>--environment<span class=w> </span>development<span class=w> </span>--url<span class=w> </span>http://localhost:8080
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=c1># the Kafka cluster</span>
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a><span class=c1># the operators</span>
</span></code></pre></div> </li> </ul> <h2 id=practices>Practices<a class=headerlink href=#practices title="Permanent link">&para;</a></h2> <ul> <li>It is not recommended to host a Flink Cluster across multiple Kubernetes clusters. Flink node exchanges data between task managers and so better to run in same region, and within same k8s. </li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../udf_sql/ class="md-footer__link md-footer__link--prev" aria-label="Previous: UDFs for SQL"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> UDFs for SQL </div> </div> </a> <a href=../datastream/ class="md-footer__link md-footer__link--next" aria-label="Next: DataStreams"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> DataStreams </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2018 - 2025 Jerome Boyer </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jbcodeforce target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/jeromeboyer target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotation", "content.code.copy", "content.tooltips", "content.tabs.link", "search.suggest", "search.highlight", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>